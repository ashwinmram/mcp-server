[
  {
    "title": "Project context from URL for Project Details MCP",
    "summary": "The project identifier is read from the query param `project` by BindMcpProject middleware and bound as app('mcp.project').",
    "category": "project-implementation",
    "subcategory": "mcp-project-details",
    "type": "project_detail",
    "tags": ["mcp", "project-details", "middleware", "project-context"],
    "content": "The Project Details MCP server uses a single route /mcp/project-details. The client connects with a URL like /mcp/project-details?project=my-app. The BindMcpProject middleware (registered as mcp.project) runs before the MCP handler: it reads request()->query('project'), validates it (required, alphanumeric/hyphens/underscores, max 255), and binds it with app()->instance('mcp.project', $project). Tools then resolve the current project via app('mcp.project') and scope queries with Lesson::bySourceProject($project). Missing or invalid project returns a JSON 422 response before the MCP server runs.",
    "metadata": {
      "file": "project_details.json",
      "session_date": "2026-02-07"
    }
  },
  {
    "title": "Project details API and import (no generic validation)",
    "summary": "POST /api/project-details uses processProjectDetails(); it skips generic validation and dedupes only within the same source_project.",
    "category": "project-implementation",
    "subcategory": "mcp-project-details",
    "type": "project_detail",
    "tags": ["mcp", "project-details", "api", "LessonImportService"],
    "content": "LessonImportService::processProjectDetails($lessons, $sourceProject) does not call LessonValidationService::validateIsGeneric. It sets is_generic => false on create/update. Deduplication uses Lesson::findByContentHash($contentHash, $sourceProject) only (same project); it does not use findByContentHashAcrossProjects. StoreProjectDetailsRequest allows type project_detail; the lessons.type enum was extended via migration add_project_detail_type_to_lessons_table to include 'project_detail'.",
    "metadata": {
      "file": "project_details.json",
      "session_date": "2026-02-07"
    }
  },
  {
    "title": "Project Details MCP tools and server",
    "summary": "ProjectDetailsServer exposes SearchProjectDetails, GetProjectDetailsByCategory, and GetProjectDetailsOverview; all scope by app('mcp.project').",
    "category": "project-implementation",
    "subcategory": "mcp-project-details",
    "type": "project_detail",
    "tags": ["mcp", "project-details", "tools", "ProjectDetailsServer"],
    "content": "ProjectDetailsServer is registered in routes/ai.php with middleware ['auth:sanctum', 'mcp.project']. Tools use Lesson::query()->projectDetails()->bySourceProject(app('mcp.project')). SearchProjectDetails supports query, category, tags, limit, include_deprecated. GetProjectDetailsByCategory requires category. GetProjectDetailsOverview returns total_entries and by_category counts. No usage tracking or relevance scoring for project details; ordering is by updated_at.",
    "metadata": {
      "file": "project_details.json",
      "session_date": "2026-02-07"
    }
  },
  {
    "title": "Pushing project details (pusher package and command)",
    "summary": "mcp:push-project-details reads docs/project-details.md and docs/project_details*.json and POSTs to /api/project-details via LessonPusherService::pushProjectDetails.",
    "category": "project-implementation",
    "subcategory": "mcp-project-details",
    "type": "project_detail",
    "tags": ["mcp", "project-details", "pusher", "artisan"],
    "content": "In packages/laravel-mcp-pusher: LessonPusherService::pushProjectDetails($lessons, $sourceProject) POSTs to rtrim(serverUrl)/api/project-details with the same auth as pushLessons. The command mcp:push-project-details has options --source, --project-details-file (default docs/project-details.md), --project-details-json-dir (default docs). Markdown is converted to one lesson with category project-implementation; JSON array entries are normalized (type project_detail or from item, category/subcategory/title/summary/tags/content/metadata). This app uses the local package via Composer path repository so the command and pushProjectDetails are available.",
    "metadata": {
      "file": "project_details.json",
      "session_date": "2026-02-07"
    }
  }
]
